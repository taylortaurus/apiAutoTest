{"config":{"lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"HTTP/HTTPS\u63a5\u53e3\u81ea\u52a8\u5316\u6d4b\u8bd5\u5de5\u5177\uff0c\u91c7\u7528Excel\u6765\u7ba1\u7406\u7528\u4f8b,\u586b\u8868\u683c\u5373\u53ef\u5b8c\u6210\u63a5\u53e3\u6d4b\u8bd5. \u529f\u80fd\u70b9 \u00b6 \u6d4b\u8bd5\u524d\u540e\u6570\u636e\u6e05\u6d17\u64cd\u4f5c \u4e1a\u52a1\u63a5\u53e3\u4e4b\u95f4\u7684\u6570\u636e\u4f9d\u8d56\u5904\u7406 \u6761\u4ef6\u52a8\u6001\u8df3\u8fc7\u7528\u4f8b \u7528\u4f8b\u4e2d\u81ea\u5b9a\u4e49\u51fd\u6570\u5b9a\u4e49\u53ca\u4f7f\u7528, \u5e94\u5bf9\u590d\u6742\u7684\u52a8\u6001\u53c2\u6570 \u652f\u6301\u540e\u7f6eSQL\u64cd\u4f5c(\u53ef\u591a\u6761), \u5e76\u5c06\u7ed3\u679c\u4f5c\u7528\u4e0e\u540e\u7eed\u7528\u4f8b\u4e2d \u652f\u6301\u52a8\u6001\u591a\u6570\u636e\u65ad\u8a00\u65b9\u5f0f \u652f\u6301\u6d4b\u8bd5\u62a5\u544a\u538b\u7f29,\u90ae\u4ef6\u53d1\u9001 \u63a5\u53e3\u5f55\u5236,\u63d0\u5347\u7528\u4f8b\u5199\u4f5c\u6548\u7387 \u8d44\u6e90\u83b7\u53d6 \u00b6 \u70b9\u51fb\u8df3\u8f6c B\u7ad9\u89c6\u9891\u89e3\u6790 Gitee GitHub \u62a5\u544a\u5c55\u793a \u00b6 \u672c\u6587\u6863\u5c06\u5c3d\u53ef\u80fd\u7684\u63cf\u8ff0\u8be5\u5de5\u5177\u7528\u6cd5","title":"\u4ecb\u7ecd"},{"location":"#_1","text":"\u6d4b\u8bd5\u524d\u540e\u6570\u636e\u6e05\u6d17\u64cd\u4f5c \u4e1a\u52a1\u63a5\u53e3\u4e4b\u95f4\u7684\u6570\u636e\u4f9d\u8d56\u5904\u7406 \u6761\u4ef6\u52a8\u6001\u8df3\u8fc7\u7528\u4f8b \u7528\u4f8b\u4e2d\u81ea\u5b9a\u4e49\u51fd\u6570\u5b9a\u4e49\u53ca\u4f7f\u7528, \u5e94\u5bf9\u590d\u6742\u7684\u52a8\u6001\u53c2\u6570 \u652f\u6301\u540e\u7f6eSQL\u64cd\u4f5c(\u53ef\u591a\u6761), \u5e76\u5c06\u7ed3\u679c\u4f5c\u7528\u4e0e\u540e\u7eed\u7528\u4f8b\u4e2d \u652f\u6301\u52a8\u6001\u591a\u6570\u636e\u65ad\u8a00\u65b9\u5f0f \u652f\u6301\u6d4b\u8bd5\u62a5\u544a\u538b\u7f29,\u90ae\u4ef6\u53d1\u9001 \u63a5\u53e3\u5f55\u5236,\u63d0\u5347\u7528\u4f8b\u5199\u4f5c\u6548\u7387","title":"\u529f\u80fd\u70b9"},{"location":"#_2","text":"\u70b9\u51fb\u8df3\u8f6c B\u7ad9\u89c6\u9891\u89e3\u6790 Gitee GitHub","title":"\u8d44\u6e90\u83b7\u53d6"},{"location":"#_3","text":"\u672c\u6587\u6863\u5c06\u5c3d\u53ef\u80fd\u7684\u63cf\u8ff0\u8be5\u5de5\u5177\u7528\u6cd5","title":"\u62a5\u544a\u5c55\u793a"},{"location":"about/","text":"\u8d44\u6e90\u83b7\u53d6 B\u7ad9\u89c6\u9891\u89e3\u6790 GitHub jdk \u94fe\u63a5\uff1a https://pan.baidu.com/s/1q9TIbHoOKIvoZMv1m7WA-g \u63d0\u53d6\u7801\uff1a2fbs allure \u94fe\u63a5\uff1a https://pan.baidu.com/s/1Tut7BDsusgChhA41ZSkrkg \u63d0\u53d6\u7801\uff1atlei \u8054\u7cfb \u6d4b\u8bd5\u4ea4\u6d41QQ\u7fa4: 930902996 B\u7ad9\uff1a https://space.bilibili.com/438858333","title":"\u5173\u4e8e"},{"location":"change/","text":"2021/05/19 apiAutoTest\u5728\u7ebf\u6587\u6863\u53d1\u5e03 2021/05/20 \u7edf\u4e00\u53c2\u6570\u6c60&\u53d8\u91cf\u6c60 \u4e3a \u53c2\u6570\u53d8\u91cf\u6c60 2021/05/22 \u589e\u52a0\u63a5\u53e3\u5f55\u5236\u4f7f\u7528 2021/11/13 \u6700\u7ec8\u4fee\u8ba2 2022/09/01 tag3.0 \u7248\u672c\u6587\u6863","title":"\u66f4\u65b0\u65e5\u5fd7"},{"location":"license/","text":"MIT License Copyright (c) 2020 zy7y Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the \"Software\"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions: The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software. THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.","title":"\u5f00\u6e90\u534f\u8bae"},{"location":"apiAutoTest/config/","text":"\u793a\u4f8b \u00b6 # config.yaml server : # \u672c\u5730\u63a5\u53e3\u670d\u52a1 test : http://127.0.0.1:8888/ dev : http://127.0.0.1:8888/api/private/v1/ # \u57fa\u51c6\u7684\u8bf7\u6c42\u5934\u4fe1\u606f request_headers : Accept-Encoding : gzip, deflate Accept-Language : zh-CN,zh;q=0.9 User-Agent : Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36 # \u76f8\u5bf9\u4e8erun.py file_path : # \u7528\u4f8b\u6570\u636e\u8def\u5f84 test_case : case_data.xls # \u62a5\u544a\u751f\u6210\u8def\u5f84 report : report/ # \u65e5\u5fd7\u6587\u4ef6\u8def\u5f84 log : logs/run{time}.log email : # \u90ae\u7bb1\u8d26\u53f7\u914d\u7f6e serve : # \u53d1\u4ef6\u4eba\u90ae\u7bb1USER user : 123456@163.com # \u53d1\u4ef6\u4eba\u90ae\u7bb1\u6388\u6743\u7801 password : xxxx # \u90ae\u7bb1host host : smtp.163.com # \u90ae\u4ef6\u5185\u5bb9\u914d\u7f6e context : contents : \u89e3\u538bapiAutoReport.zip(\u63a5\u53e3\u6d4b\u8bd5\u62a5\u544a)\u540e\uff0c\u8bf7\u4f7f\u7528\u5df2\u5b89\u88c5Live Server \u63d2\u4ef6\u7684VsCode\uff0c\u6253\u5f00\u89e3\u538b\u76ee\u5f55\u4e0b\u7684index.html\u67e5\u770b\u62a5\u544a # \u6536\u4ef6\u4eba\u90ae\u7bb1 to : [ \"396667207@qq.com\" ] subject : \u63a5\u53e3\u81ea\u52a8\u5316\u6d4b\u8bd5\u62a5\u544a(\u89c1\u9644\u4ef6) # \u9644\u4ef6 attachments : report.zip # \u6570\u636e\u5e93\u6821\u9a8c- mysql database : # \u6570\u636e\u5e93\u5730\u5740 host : localhost # \u6570\u636e\u5e93\u7aef\u53e3 port : 3306 # \u6570\u636e\u5e93\u7528\u6237\u540d user : root # \u4e0d\u7528''\u4f1a\u88ab\u89e3\u6790\u6210int\u7c7b\u578b\u6570\u636e\uff0c \u6570\u636e\u5e93\u5bc6\u7801 password : '123456' # \u6570\u636e\u5e93\u540d\u79f0 db : mydb # \u6570\u636e\u5e93\u6240\u5728\u7684\u670d\u52a1\u5668\u914d\u7f6e\uff0c\u7528\u4e8e\u5907\u4efd/\u8fd8\u539f\u6570\u636e\u6587\u4ef6\uff0c\u8fbe\u5230\u6570\u636e\u6e05\u6d17 ssh_server : port : 22 username : root password : '123456' # \u79c1\u6709\u5bc6\u94a5\u6587\u4ef6\u8def\u5f84 private_key_file : # \u79c1\u94a5\u5bc6\u7801 private_password : # \u5982\u679c\u4f7f\u7528\u7684docker\u5bb9\u5668\u90e8\u7f72mysql\u670d\u52a1\uff0c\u9700\u8981\u4f20\u5165mysql\u7684\u5bb9\u5668id/name mysql_container : mysql8 # \u6570\u636e\u5e93\u5907\u4efd\u6587\u4ef6\u5bfc\u51fa\u7684\u672c\u5730\u8def\u5f84, \u9700\u8981\u4fdd\u8bc1\u5b58\u5728\u8be5\u6587\u4ef6\u5939 sql_data_file : backup_sql/ server \u00b6 \u6700\u7ec8\u8bf7\u6c42\u5730\u5740 = \u57fa\u51c6\u5730\u5740 + \u7528\u4f8b\u63a5\u53e3\u5730\u5740 \u670d\u52a1\u7684\u57fa\u51c6\u5730\u5740(\u4e2a\u4eba\u7406\u89e3\u591a\u4e2a\u63a5\u53e3\u90fd\u6709\u7684\u5171\u540c\u90e8\u5206\u5185\u5bb9)\uff0c\u9ed8\u8ba4\u4f7f\u7528\u7684\u662f dev \u4fee\u6539\u73af\u5883- core.py ... @property def path ( self ): return self . _path @path . setter def path ( self , value ): # self.config.get_config(\"$.server.test\") \u4f7f\u7528test\u7684 \u57fa\u51c6\u5730\u5740 self . config . get_config ( \"$.server.dev\" ) self . _path = f \" { self . config . current }{ DataProcess . rep_expr ( value ) } \" ... request_headers \u00b6 \u6700\u7ec8\u8bf7\u6c42\u5934 = \u57fa\u51c6\u8bf7\u6c42\u5934 + \u7528\u4f8b\u4e2d\u7684\u8bf7\u6c42\u5934 \u57fa\u51c6\u8bf7\u6c42\u5934\uff0c\u5373\u4e3a\u9ed8\u8ba4\u6240\u6709\u63a5\u53e3\u90fd\u4f1a\u4f7f\u7528\u7684\u57fa\u7840\u8bf7\u6c42\u5934\u6570\u636e file_path \u00b6 \u6b64\u5904\u7684\u8def\u5f84\u662f\u76f8\u5bf9 run.py \u7684\u8def\u5f84 \u6307\u5b9a\u7528\u4f8b\u6587\u4ef6\u5730\u5740\uff0c\u62a5\u544a\u751f\u6210\u5730\u5740\uff0clog\u4fdd\u5b58\u5730\u5740 email \u00b6 \u901a\u8fc7 python run.py \u8fd0\u884c\uff08jenkins\u96c6\u6210\u53ef\u5ffd\u7565\uff09, \u4fee\u6539 run.py ... if __name__ == \"__main__\" : run ( email = True ) ... database \u00b6 \u53ea\u652f\u6301mysql\u6570\u636e\u5e93, \u4f7f\u7528\u65f6\uff0c test_main.py ... def test_start ( case , get_db ): # \u53ea\u4f7f\u7528\u6570\u636e\u5e93\u64cd\u4f5c \"\"\" \u6d4b\u8bd5\u542f\u52a8\u65b9\u6cd5\uff0c \u5f53\u9700\u8981\u4f7f\u7528 \u6570\u636e\u6e05\u6d17\u548c \u6570\u636e\u5e93\u64cd\u4f5c\u547d\u4ee4\u65f6\u5c06 get_db \u6362\u6210 clear_db \u5982\u53ea\u9700\u8981\u4f7f\u7528 \u6570\u636e\u5e93\u64cd\u4f5c \u5219\u6dfb\u52a0get_db \u53c2\u6570\uff0c \u5982\u4e00\u4e2a\u90fd\u4e0d\u9700\u8981\u5219\u4e0d\u6dfb\u52a0 :param case: \u7528\u4f8b :return: \"\"\" # \u524d\u7f6e\u5904\u7406 title , skip , header , path , method , data_type , file , data , extra , sql , expect = case ReportStyle . title ( title ) data_process . handle_case ( path , header , skip , data , file ) # \u53d1\u9001\u8bf7\u6c42 http_client . send_request ( data_type , method , data_process . path , data_process . headers , data_process . body , data_process . files , ) # \u540e\u7f6e\u5904\u7406 DataProcess . handle_extra ( extra , http_client . response . json ()) data_process . sql = sql data_process . handle_sql ( get_db ) # \u4f7f\u7528\u6570\u636e\u5e93 # \u65ad\u8a00 DataProcess . assert_result ( http_client . response . json (), expect ) ... ssh_server \u00b6 \u6570\u636e\u9694\u79bb\u64cd\u4f5c\uff0c \u4f7f\u7528\u65f6, test_main.py def test_start ( case , clear_db ): # \u4f7f\u7528\u6570\u636e\u5e93\u64cd\u4f5c \u53ca \u6570\u636e\u6e05\u6d17 \"\"\" \u6d4b\u8bd5\u542f\u52a8\u65b9\u6cd5\uff0c \u5f53\u9700\u8981\u4f7f\u7528 \u6570\u636e\u6e05\u6d17\u548c \u6570\u636e\u5e93\u64cd\u4f5c\u547d\u4ee4\u65f6\u5c06 get_db \u6362\u6210 clear_db \u5982\u53ea\u9700\u8981\u4f7f\u7528 \u6570\u636e\u5e93\u64cd\u4f5c \u5219\u6dfb\u52a0get_db \u53c2\u6570\uff0c \u5982\u4e00\u4e2a\u90fd\u4e0d\u9700\u8981\u5219\u4e0d\u6dfb\u52a0 :param case: \u7528\u4f8b :return: \"\"\" # \u524d\u7f6e\u5904\u7406 title , skip , header , path , method , data_type , file , data , extra , sql , expect = case ReportStyle . title ( title ) data_process . handle_case ( path , header , skip , data , file ) # \u53d1\u9001\u8bf7\u6c42 http_client . send_request ( data_type , method , data_process . path , data_process . headers , data_process . body , data_process . files , ) # \u540e\u7f6e\u5904\u7406 DataProcess . handle_extra ( extra , http_client . response . json ()) data_process . sql = sql data_process . handle_sql ( clear_db ) # \u4f7f\u7528\u6570\u636e\u6e05\u6d17\u53ca \u6570\u636e\u5e93 # \u65ad\u8a00 DataProcess . assert_result ( http_client . response . json (), expect )","title":"3. \u914d\u7f6e\u6587\u4ef6"},{"location":"apiAutoTest/config/#_1","text":"# config.yaml server : # \u672c\u5730\u63a5\u53e3\u670d\u52a1 test : http://127.0.0.1:8888/ dev : http://127.0.0.1:8888/api/private/v1/ # \u57fa\u51c6\u7684\u8bf7\u6c42\u5934\u4fe1\u606f request_headers : Accept-Encoding : gzip, deflate Accept-Language : zh-CN,zh;q=0.9 User-Agent : Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36 # \u76f8\u5bf9\u4e8erun.py file_path : # \u7528\u4f8b\u6570\u636e\u8def\u5f84 test_case : case_data.xls # \u62a5\u544a\u751f\u6210\u8def\u5f84 report : report/ # \u65e5\u5fd7\u6587\u4ef6\u8def\u5f84 log : logs/run{time}.log email : # \u90ae\u7bb1\u8d26\u53f7\u914d\u7f6e serve : # \u53d1\u4ef6\u4eba\u90ae\u7bb1USER user : 123456@163.com # \u53d1\u4ef6\u4eba\u90ae\u7bb1\u6388\u6743\u7801 password : xxxx # \u90ae\u7bb1host host : smtp.163.com # \u90ae\u4ef6\u5185\u5bb9\u914d\u7f6e context : contents : \u89e3\u538bapiAutoReport.zip(\u63a5\u53e3\u6d4b\u8bd5\u62a5\u544a)\u540e\uff0c\u8bf7\u4f7f\u7528\u5df2\u5b89\u88c5Live Server \u63d2\u4ef6\u7684VsCode\uff0c\u6253\u5f00\u89e3\u538b\u76ee\u5f55\u4e0b\u7684index.html\u67e5\u770b\u62a5\u544a # \u6536\u4ef6\u4eba\u90ae\u7bb1 to : [ \"396667207@qq.com\" ] subject : \u63a5\u53e3\u81ea\u52a8\u5316\u6d4b\u8bd5\u62a5\u544a(\u89c1\u9644\u4ef6) # \u9644\u4ef6 attachments : report.zip # \u6570\u636e\u5e93\u6821\u9a8c- mysql database : # \u6570\u636e\u5e93\u5730\u5740 host : localhost # \u6570\u636e\u5e93\u7aef\u53e3 port : 3306 # \u6570\u636e\u5e93\u7528\u6237\u540d user : root # \u4e0d\u7528''\u4f1a\u88ab\u89e3\u6790\u6210int\u7c7b\u578b\u6570\u636e\uff0c \u6570\u636e\u5e93\u5bc6\u7801 password : '123456' # \u6570\u636e\u5e93\u540d\u79f0 db : mydb # \u6570\u636e\u5e93\u6240\u5728\u7684\u670d\u52a1\u5668\u914d\u7f6e\uff0c\u7528\u4e8e\u5907\u4efd/\u8fd8\u539f\u6570\u636e\u6587\u4ef6\uff0c\u8fbe\u5230\u6570\u636e\u6e05\u6d17 ssh_server : port : 22 username : root password : '123456' # \u79c1\u6709\u5bc6\u94a5\u6587\u4ef6\u8def\u5f84 private_key_file : # \u79c1\u94a5\u5bc6\u7801 private_password : # \u5982\u679c\u4f7f\u7528\u7684docker\u5bb9\u5668\u90e8\u7f72mysql\u670d\u52a1\uff0c\u9700\u8981\u4f20\u5165mysql\u7684\u5bb9\u5668id/name mysql_container : mysql8 # \u6570\u636e\u5e93\u5907\u4efd\u6587\u4ef6\u5bfc\u51fa\u7684\u672c\u5730\u8def\u5f84, \u9700\u8981\u4fdd\u8bc1\u5b58\u5728\u8be5\u6587\u4ef6\u5939 sql_data_file : backup_sql/","title":"\u793a\u4f8b"},{"location":"apiAutoTest/config/#server","text":"\u6700\u7ec8\u8bf7\u6c42\u5730\u5740 = \u57fa\u51c6\u5730\u5740 + \u7528\u4f8b\u63a5\u53e3\u5730\u5740 \u670d\u52a1\u7684\u57fa\u51c6\u5730\u5740(\u4e2a\u4eba\u7406\u89e3\u591a\u4e2a\u63a5\u53e3\u90fd\u6709\u7684\u5171\u540c\u90e8\u5206\u5185\u5bb9)\uff0c\u9ed8\u8ba4\u4f7f\u7528\u7684\u662f dev \u4fee\u6539\u73af\u5883- core.py ... @property def path ( self ): return self . _path @path . setter def path ( self , value ): # self.config.get_config(\"$.server.test\") \u4f7f\u7528test\u7684 \u57fa\u51c6\u5730\u5740 self . config . get_config ( \"$.server.dev\" ) self . _path = f \" { self . config . current }{ DataProcess . rep_expr ( value ) } \" ...","title":"server"},{"location":"apiAutoTest/config/#request_headers","text":"\u6700\u7ec8\u8bf7\u6c42\u5934 = \u57fa\u51c6\u8bf7\u6c42\u5934 + \u7528\u4f8b\u4e2d\u7684\u8bf7\u6c42\u5934 \u57fa\u51c6\u8bf7\u6c42\u5934\uff0c\u5373\u4e3a\u9ed8\u8ba4\u6240\u6709\u63a5\u53e3\u90fd\u4f1a\u4f7f\u7528\u7684\u57fa\u7840\u8bf7\u6c42\u5934\u6570\u636e","title":"request_headers"},{"location":"apiAutoTest/config/#file_path","text":"\u6b64\u5904\u7684\u8def\u5f84\u662f\u76f8\u5bf9 run.py \u7684\u8def\u5f84 \u6307\u5b9a\u7528\u4f8b\u6587\u4ef6\u5730\u5740\uff0c\u62a5\u544a\u751f\u6210\u5730\u5740\uff0clog\u4fdd\u5b58\u5730\u5740","title":"file_path"},{"location":"apiAutoTest/config/#email","text":"\u901a\u8fc7 python run.py \u8fd0\u884c\uff08jenkins\u96c6\u6210\u53ef\u5ffd\u7565\uff09, \u4fee\u6539 run.py ... if __name__ == \"__main__\" : run ( email = True ) ...","title":"email"},{"location":"apiAutoTest/config/#database","text":"\u53ea\u652f\u6301mysql\u6570\u636e\u5e93, \u4f7f\u7528\u65f6\uff0c test_main.py ... def test_start ( case , get_db ): # \u53ea\u4f7f\u7528\u6570\u636e\u5e93\u64cd\u4f5c \"\"\" \u6d4b\u8bd5\u542f\u52a8\u65b9\u6cd5\uff0c \u5f53\u9700\u8981\u4f7f\u7528 \u6570\u636e\u6e05\u6d17\u548c \u6570\u636e\u5e93\u64cd\u4f5c\u547d\u4ee4\u65f6\u5c06 get_db \u6362\u6210 clear_db \u5982\u53ea\u9700\u8981\u4f7f\u7528 \u6570\u636e\u5e93\u64cd\u4f5c \u5219\u6dfb\u52a0get_db \u53c2\u6570\uff0c \u5982\u4e00\u4e2a\u90fd\u4e0d\u9700\u8981\u5219\u4e0d\u6dfb\u52a0 :param case: \u7528\u4f8b :return: \"\"\" # \u524d\u7f6e\u5904\u7406 title , skip , header , path , method , data_type , file , data , extra , sql , expect = case ReportStyle . title ( title ) data_process . handle_case ( path , header , skip , data , file ) # \u53d1\u9001\u8bf7\u6c42 http_client . send_request ( data_type , method , data_process . path , data_process . headers , data_process . body , data_process . files , ) # \u540e\u7f6e\u5904\u7406 DataProcess . handle_extra ( extra , http_client . response . json ()) data_process . sql = sql data_process . handle_sql ( get_db ) # \u4f7f\u7528\u6570\u636e\u5e93 # \u65ad\u8a00 DataProcess . assert_result ( http_client . response . json (), expect ) ...","title":"database"},{"location":"apiAutoTest/config/#ssh_server","text":"\u6570\u636e\u9694\u79bb\u64cd\u4f5c\uff0c \u4f7f\u7528\u65f6, test_main.py def test_start ( case , clear_db ): # \u4f7f\u7528\u6570\u636e\u5e93\u64cd\u4f5c \u53ca \u6570\u636e\u6e05\u6d17 \"\"\" \u6d4b\u8bd5\u542f\u52a8\u65b9\u6cd5\uff0c \u5f53\u9700\u8981\u4f7f\u7528 \u6570\u636e\u6e05\u6d17\u548c \u6570\u636e\u5e93\u64cd\u4f5c\u547d\u4ee4\u65f6\u5c06 get_db \u6362\u6210 clear_db \u5982\u53ea\u9700\u8981\u4f7f\u7528 \u6570\u636e\u5e93\u64cd\u4f5c \u5219\u6dfb\u52a0get_db \u53c2\u6570\uff0c \u5982\u4e00\u4e2a\u90fd\u4e0d\u9700\u8981\u5219\u4e0d\u6dfb\u52a0 :param case: \u7528\u4f8b :return: \"\"\" # \u524d\u7f6e\u5904\u7406 title , skip , header , path , method , data_type , file , data , extra , sql , expect = case ReportStyle . title ( title ) data_process . handle_case ( path , header , skip , data , file ) # \u53d1\u9001\u8bf7\u6c42 http_client . send_request ( data_type , method , data_process . path , data_process . headers , data_process . body , data_process . files , ) # \u540e\u7f6e\u5904\u7406 DataProcess . handle_extra ( extra , http_client . response . json ()) data_process . sql = sql data_process . handle_sql ( clear_db ) # \u4f7f\u7528\u6570\u636e\u6e05\u6d17\u53ca \u6570\u636e\u5e93 # \u65ad\u8a00 DataProcess . assert_result ( http_client . response . json (), expect )","title":"ssh_server"},{"location":"apiAutoTest/hooks/","text":"\u673a\u5236 \u6709\u4e9b\u7279\u6b8a\u53c2\u6570\u751f\u6210\u89c4\u5219, \u5982md5\u52a0\u89e3\u5bc6\u7b49, \u5219\u53ef\u5728\u6b64\u5904\u5b9a\u4e49 \u5b9a\u4e49\u4e4b\u540e\u4f7f\u7528 ${\u65b9\u6cd5\u540d()} \u8c03\u7528\u65e0\u53c2\u51fd\u6570, ${\u65b9\u6cd5\u540d(\u53c2\u6570\u540d)} \u8c03\u7528\u6709\u53c2\u51fd\u6570 hooks.py # hooks.py #!/usr/bin/env python # _*_ coding: utf-8 _*_ \"\"\" @project: apiAutoTest @file: hooks.py @author: zy7y @time: 2021/2/27 @site: https://cnblogs.com/zy7y @github: https://github.com/zy7y @gitee: https://gitee.com/zy7y @desc: \u6269\u5c55\u65b9\u6cd5, 2021/02/27 \u5173\u4e8eexec\u6267\u884cpython\u4ee3\u7801\u53ef\u67e5\u9605\u8d44\u6599\uff1ahttps://python3-cookbook.readthedocs.io/zh_CN/latest/c09/p23_executing_code_with_local_side_effects.html \"\"\" import time def get_current_highest (): \"\"\"\u83b7\u53d6\u5f53\u524d\u65f6\u95f4\u6233\"\"\" return int ( time . time ()) def set_token ( token : str ): \"\"\"\u8bbe\u7f6etoken\uff0c\u76f4\u63a5\u8fd4\u56de\u5b57\u5178\"\"\" return { \"Authorization\" : token } def sum_data ( a , b ): \"\"\"\u8ba1\u7b97\u51fd\u6570\"\"\" return a + b \u8bf7\u6c42\u8def\u5f84\u4f7f\u7528\u81ea\u5b9a\u4e49\u51fd\u6570 \u00b6 \u7528\u4f8b\u6807\u9898 \u662f\u5426\u8df3\u8fc7 \u8bf7\u6c42\u5934 \u8bf7\u6c42\u5730\u5740 \u8bf7\u6c42\u65b9\u5f0f \u5165\u53c2\u5173\u952e\u5b57 \u4e0a\u4f20\u6587\u4ef6 \u8bf7\u6c42\u6570\u636e \u63d0\u53d6\u53c2\u6570 \u540e\u7f6eSQL \u9884\u671f\u7ed3\u679c \u767b\u5f55 FALSE {\"timer\": \"${get_current_highest()}\"} login/${get_current_highest()} post data {\"username\": \"admin\", \"password\": \"\"} {\"msg\":\"$.meta.msg\"} select * from apis; {\"$.meta.status\":400} \u8bf7\u6c42\u6570\u636e\u5904\u7406: \u5047\u8bbe\u57fa\u51c6\u5730\u5740\u4f7f\u7528\u7684\u662f dev : http://www.ysqorz.top:8888/api/private/v1/ \u5047\u8bbe\u5f53\u524d\u65f6\u95f4\u6233\u4e3a: 1621422609 \u6700\u7ec8\u8bf7\u6c42\u5730\u5740\u4e3a: http://www.ysqorz.top:8888/api/private/v1/login/1621422609 \u8bf7\u6c42\u6570\u636e\u4f7f\u7528\u81ea\u5b9a\u4e49\u51fd\u6570 \u00b6 \u8bf7\u6c42\u6570\u636e \u8bf7\u6c42\u5934\u4f7f\u7528\u81ea\u5b9a\u4e49\u51fd\u6570 \u00b6 \u8bf7\u6c42\u5934\u6570\u636e\u5904\u7406: config.yaml \u4e2d request_header \u914d\u7f6e\u5982\u4e0b: # \u57fa\u51c6\u7684\u8bf7\u6c42\u5934\u4fe1\u606f request_headers : Accept-Encoding : gzip, deflate Accept-Language : zh-CN,zh;q=0.9 User-Agent : Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36 \u6700\u7ec8\u8bf7\u6c42\u5934\u6570\u636e\u5982\u4e0b: { \"Accept-Encoding\" : \"gzip, deflate\" , \"Accept-Language\" : \"zh-CN,zh;q=0.9\" , \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36\" , \"timer\" : \"1621422609\" }","title":"5. \u81ea\u5b9a\u4e49\u51fd\u6570"},{"location":"apiAutoTest/hooks/#_1","text":"\u7528\u4f8b\u6807\u9898 \u662f\u5426\u8df3\u8fc7 \u8bf7\u6c42\u5934 \u8bf7\u6c42\u5730\u5740 \u8bf7\u6c42\u65b9\u5f0f \u5165\u53c2\u5173\u952e\u5b57 \u4e0a\u4f20\u6587\u4ef6 \u8bf7\u6c42\u6570\u636e \u63d0\u53d6\u53c2\u6570 \u540e\u7f6eSQL \u9884\u671f\u7ed3\u679c \u767b\u5f55 FALSE {\"timer\": \"${get_current_highest()}\"} login/${get_current_highest()} post data {\"username\": \"admin\", \"password\": \"\"} {\"msg\":\"$.meta.msg\"} select * from apis; {\"$.meta.status\":400} \u8bf7\u6c42\u6570\u636e\u5904\u7406: \u5047\u8bbe\u57fa\u51c6\u5730\u5740\u4f7f\u7528\u7684\u662f dev : http://www.ysqorz.top:8888/api/private/v1/ \u5047\u8bbe\u5f53\u524d\u65f6\u95f4\u6233\u4e3a: 1621422609 \u6700\u7ec8\u8bf7\u6c42\u5730\u5740\u4e3a: http://www.ysqorz.top:8888/api/private/v1/login/1621422609","title":"\u8bf7\u6c42\u8def\u5f84\u4f7f\u7528\u81ea\u5b9a\u4e49\u51fd\u6570"},{"location":"apiAutoTest/hooks/#_2","text":"\u8bf7\u6c42\u6570\u636e","title":"\u8bf7\u6c42\u6570\u636e\u4f7f\u7528\u81ea\u5b9a\u4e49\u51fd\u6570"},{"location":"apiAutoTest/hooks/#_3","text":"\u8bf7\u6c42\u5934\u6570\u636e\u5904\u7406: config.yaml \u4e2d request_header \u914d\u7f6e\u5982\u4e0b: # \u57fa\u51c6\u7684\u8bf7\u6c42\u5934\u4fe1\u606f request_headers : Accept-Encoding : gzip, deflate Accept-Language : zh-CN,zh;q=0.9 User-Agent : Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36 \u6700\u7ec8\u8bf7\u6c42\u5934\u6570\u636e\u5982\u4e0b: { \"Accept-Encoding\" : \"gzip, deflate\" , \"Accept-Language\" : \"zh-CN,zh;q=0.9\" , \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36\" , \"timer\" : \"1621422609\" }","title":"\u8bf7\u6c42\u5934\u4f7f\u7528\u81ea\u5b9a\u4e49\u51fd\u6570"},{"location":"apiAutoTest/jenkins/","text":"\u8d44\u6599 \u00b6 apiAutoTest\u96c6\u6210Jenkins","title":"6. Jenkins\u96c6\u6210"},{"location":"apiAutoTest/jenkins/#_1","text":"apiAutoTest\u96c6\u6210Jenkins","title":"\u8d44\u6599"},{"location":"apiAutoTest/recording/","text":"\u673a\u5236 \u00b6 \u57fa\u4e8emitmproxy, \u6293\u5305\u5fae\u4fe1\u5c0f\u7a0b\u5e8f \u4f7f\u7528\u5176\u63d0\u4f9b\u7684\u6269\u5c55API, \u901a\u8fc7mitmproxy \u5b9e\u73b0\u4ee3\u7406\u4e4b\u540e\u6355\u83b7\u5230HTTP/HTTPS\u8bf7\u6c42,\u5e76\u628a\u8bf7\u6c42\u5df2\u8ffd\u52a0\u7684\u5f62\u5f0f\u6dfb\u52a0\u5230excel\u4e2d\uff0c\u5f53\u5f55\u5236\u5b8c\u6210\u52a1\u5fc5\u4f7f\u7528ctrl + c \u5173\u95ed\u5f55\u5236\uff0c\u5c06\u751f\u6210\u4e00\u4e2a\u5b8c\u6210\u7684\u7528\u4f8b\u6570\u636e\u6587\u4ef6 \u53ef\u6307\u5b9a\u5f55\u5236\u5305\u542b\u8bf7\u6c42\u5730\u5740\u7684\u63a5\u53e3 \u5982\u4f55\u5f55\u5236 \u00b6 \u524d\u7f6e\u6761\u4ef6: https://www.cnblogs.com/zy7y/p/14798151.html \u6253\u5f00\u672c\u673a\u4ee3\u7406 \u4fee\u6539 recording.py \u4e2d\u914d\u7f6e\u6293\u5305\u8bf7\u6c42\u5730\u5740, \u7528\u4f8b\u751f\u6210\u8def\u5f84 apiAutoTest \u6839\u76ee\u5f55\u4e0b\u6267\u884c mitmweb -s recording.py \u6b63\u5e38\u53bb\u4f7f\u7528\u5c31\u884c\u4e86\uff0c\u5f53\u4e0d\u9700\u8981\u5f55\u5236\u7684\u65f6\u5019 \u5728\u4e0a\u9762\u8fd9\u4e2a\u7a97\u53e3 Ctrl + C \u505c\u6b62\u5f55\u5236\uff0c\u7136\u540e\u5173\u95ed\u672c\u673a\u4ee3\u7406 \u4f7f\u7528\u5f55\u5236\u7684\u7528\u4f8b \u00b6 config.yaml \u4fee\u6539\u57fa\u51c6\u5730\u5740 dev \u4e3a \"\" ,\u6307\u5b9a\u4f7f\u7528\u5f55\u5236\u7684\u7528\u4f8b\u6587\u4ef6 server : # \u672c\u5730\u63a5\u53e3\u670d\u52a1 test : http://127.0.0.1:8888/ # https://space.bilibili.com/283273603 \u6f14\u793a\u9879\u76ee\u540e\u7aef\u670d\u52a1\u6765\u81ea # dev: http://www.ysqorz.top:8888/api/private/v1/ dev : '' # \u57fa\u51c6\u7684\u8bf7\u6c42\u5934\u4fe1\u606f request_headers : {} file_path : test_case : case_data1.xls # \u6307\u5b9a\u4f7f\u7528\u90a3\u4e2a\u7528\u4f8b\uff0c\u8fd9\u91cc\u4f7f\u7528\u4e86\u5f55\u5236\u7684\u7528\u4f8b report : report/ log : logs/run{time}.log .... \u6267\u884c\u7ed3\u679c \u00b6","title":"7. \u63a5\u53e3\u5f55\u5236"},{"location":"apiAutoTest/recording/#_1","text":"\u57fa\u4e8emitmproxy, \u6293\u5305\u5fae\u4fe1\u5c0f\u7a0b\u5e8f \u4f7f\u7528\u5176\u63d0\u4f9b\u7684\u6269\u5c55API, \u901a\u8fc7mitmproxy \u5b9e\u73b0\u4ee3\u7406\u4e4b\u540e\u6355\u83b7\u5230HTTP/HTTPS\u8bf7\u6c42,\u5e76\u628a\u8bf7\u6c42\u5df2\u8ffd\u52a0\u7684\u5f62\u5f0f\u6dfb\u52a0\u5230excel\u4e2d\uff0c\u5f53\u5f55\u5236\u5b8c\u6210\u52a1\u5fc5\u4f7f\u7528ctrl + c \u5173\u95ed\u5f55\u5236\uff0c\u5c06\u751f\u6210\u4e00\u4e2a\u5b8c\u6210\u7684\u7528\u4f8b\u6570\u636e\u6587\u4ef6 \u53ef\u6307\u5b9a\u5f55\u5236\u5305\u542b\u8bf7\u6c42\u5730\u5740\u7684\u63a5\u53e3","title":"\u673a\u5236"},{"location":"apiAutoTest/recording/#_2","text":"\u524d\u7f6e\u6761\u4ef6: https://www.cnblogs.com/zy7y/p/14798151.html \u6253\u5f00\u672c\u673a\u4ee3\u7406 \u4fee\u6539 recording.py \u4e2d\u914d\u7f6e\u6293\u5305\u8bf7\u6c42\u5730\u5740, \u7528\u4f8b\u751f\u6210\u8def\u5f84 apiAutoTest \u6839\u76ee\u5f55\u4e0b\u6267\u884c mitmweb -s recording.py \u6b63\u5e38\u53bb\u4f7f\u7528\u5c31\u884c\u4e86\uff0c\u5f53\u4e0d\u9700\u8981\u5f55\u5236\u7684\u65f6\u5019 \u5728\u4e0a\u9762\u8fd9\u4e2a\u7a97\u53e3 Ctrl + C \u505c\u6b62\u5f55\u5236\uff0c\u7136\u540e\u5173\u95ed\u672c\u673a\u4ee3\u7406","title":"\u5982\u4f55\u5f55\u5236"},{"location":"apiAutoTest/recording/#_3","text":"config.yaml \u4fee\u6539\u57fa\u51c6\u5730\u5740 dev \u4e3a \"\" ,\u6307\u5b9a\u4f7f\u7528\u5f55\u5236\u7684\u7528\u4f8b\u6587\u4ef6 server : # \u672c\u5730\u63a5\u53e3\u670d\u52a1 test : http://127.0.0.1:8888/ # https://space.bilibili.com/283273603 \u6f14\u793a\u9879\u76ee\u540e\u7aef\u670d\u52a1\u6765\u81ea # dev: http://www.ysqorz.top:8888/api/private/v1/ dev : '' # \u57fa\u51c6\u7684\u8bf7\u6c42\u5934\u4fe1\u606f request_headers : {} file_path : test_case : case_data1.xls # \u6307\u5b9a\u4f7f\u7528\u90a3\u4e2a\u7528\u4f8b\uff0c\u8fd9\u91cc\u4f7f\u7528\u4e86\u5f55\u5236\u7684\u7528\u4f8b report : report/ log : logs/run{time}.log ....","title":"\u4f7f\u7528\u5f55\u5236\u7684\u7528\u4f8b"},{"location":"apiAutoTest/recording/#_4","text":"","title":"\u6267\u884c\u7ed3\u679c"},{"location":"apiAutoTest/structure/","text":"\u251c\u2500.gitignore # \u9879\u76ee git \u5ffd\u7565\u6587\u4ef6 \u251c\u2500LICENSE # \u5f00\u6e90MIT\u534f\u8bae \u251c\u2500README.md # \u9879\u76ee\u4ecb\u7ecd \u251c\u2500backup_sql # \u9ed8\u8ba4\u88abgit\u5ffd\u7565 \u2502 \u2514\u2500xxx.sql # \u6570\u636e\u5e93\u5907\u4efd\u6587\u4ef6 \u251c\u2500logs # \u9ed8\u8ba4\u88abgit\u5ffd\u7565 \u2502 \u2514\u2500run...x.log # \u65e5\u5fd7\u6587\u4ef6 \u251c\u2500report # \u9ed8\u8ba4\u88abgit\u5ffd\u7565 \u2502 \u251c\u2500data \u2502 \u2514\u2500html # allure\u62a5\u544a \u251c\u2500case_data.xls # \u7528\u4f8b\u6587\u4ef6 \u251c\u2500config.yaml # \u914d\u7f6e\u6587\u4ef6 \u251c\u2500core.py # \u6838\u5fc3\u529f\u80fd\u5c01\u88c5 \u2502\u2500hooks.py # \u81ea\u5b9a\u4e49\u6269\u5c55\u65b9\u6cd5(\u53ef\u7528\u4e8e\u7528\u4f8b)\u6587\u4ef6 \u2502\u2500recording.py # \u63a5\u53e3\u5f55\u5236,\u5199\u5165\u7528\u4f8b\u6587\u4ef6 \u251c\u2500requirements.txt # \u9879\u76ee\u4f9d\u8d56\u5e93\u6587\u4ef6 \u251c\u2500run.py # Python \u542f\u52a8\u6587\u4ef6 \u2514\u2500test_main.py # Pytest \u542f\u52a8\u6587\u4ef6 \u6d4b\u8bd5\u903b\u8f91\u5165\u53e3","title":"2. \u76ee\u5f55\u7ed3\u6784"},{"location":"apiAutoTest/use/","text":"\u73af\u5883\u51c6\u5907 \u00b6 \u642d\u5efa\u88ab\u6d4b\u670d\u52a1 git clone https://gitee.com/wBekvam/vueShop-api-server.git java jdk\u4e0b\u8f7d\uff1a \u94fe\u63a5\uff1a https://pan.baidu.com/s/1q9TIbHoOKIvoZMv1m7WA-g \u63d0\u53d6\u7801\uff1a2fbs \u73af\u5883\u642d\u5efa: https://www.cnblogs.com/zy7y/p/13345421.html allure \u94fe\u63a5\uff1a https://pan.baidu.com/s/1Tut7BDsusgChhA41ZSkrkg \u63d0\u53d6\u7801\uff1atlei python \u7248\u672c >= 3.8 git clone https://gitee.com/zy7y/apiAutoTest.git git clone https://github.com/zy7y/apiAutoTest.git \u4f53\u9a8c \u00b6 \u754c\u9762\u64cd\u4f5c \u4f7f\u7528Pycharm\u6253\u5f00 apiAutoTest \u9879\u76ee \u65b0\u5efa\u865a\u62df\u73af\u5883 \u5b89\u88c5\u4f9d\u8d56 \u8fd0\u884c \u67e5\u770b\u62a5\u544a \u00b6 \u8def\u5f84\u5730\u5740: report/html \u547d\u4ee4\u884c\u64cd\u4f5c \u00b6 \u4f7f\u7528Pycharm\u6253\u5f00 apiAutoTest \u9879\u76ee \u65b0\u5efa\u865a\u62df\u73af\u5883 # \u547d\u4ee4\u884c\u4f7f\u7528 python -m venv venv # mac/linux python3 -m venv venv \u6fc0\u6d3b\u865a\u62df\u73af\u5883 # windows venv \\S cripts \\a ctivate # mac/linux source venv/bin/activate \u5b89\u88c5\u4f9d\u8d56 # windows pip install -r requirements.txt # mac / linux pip3 install -r requirements.txt \u8fd0\u884c # windows python run.py # mac/linux python3 run.py","title":"1. \u8fdb\u884c\u4f53\u9a8c"},{"location":"apiAutoTest/use/#_1","text":"\u642d\u5efa\u88ab\u6d4b\u670d\u52a1 git clone https://gitee.com/wBekvam/vueShop-api-server.git java jdk\u4e0b\u8f7d\uff1a \u94fe\u63a5\uff1a https://pan.baidu.com/s/1q9TIbHoOKIvoZMv1m7WA-g \u63d0\u53d6\u7801\uff1a2fbs \u73af\u5883\u642d\u5efa: https://www.cnblogs.com/zy7y/p/13345421.html allure \u94fe\u63a5\uff1a https://pan.baidu.com/s/1Tut7BDsusgChhA41ZSkrkg \u63d0\u53d6\u7801\uff1atlei python \u7248\u672c >= 3.8 git clone https://gitee.com/zy7y/apiAutoTest.git git clone https://github.com/zy7y/apiAutoTest.git","title":"\u73af\u5883\u51c6\u5907"},{"location":"apiAutoTest/use/#_2","text":"\u754c\u9762\u64cd\u4f5c \u4f7f\u7528Pycharm\u6253\u5f00 apiAutoTest \u9879\u76ee \u65b0\u5efa\u865a\u62df\u73af\u5883 \u5b89\u88c5\u4f9d\u8d56 \u8fd0\u884c","title":"\u4f53\u9a8c"},{"location":"apiAutoTest/use/#_3","text":"\u8def\u5f84\u5730\u5740: report/html","title":"\u67e5\u770b\u62a5\u544a"},{"location":"apiAutoTest/use/#_4","text":"\u4f7f\u7528Pycharm\u6253\u5f00 apiAutoTest \u9879\u76ee \u65b0\u5efa\u865a\u62df\u73af\u5883 # \u547d\u4ee4\u884c\u4f7f\u7528 python -m venv venv # mac/linux python3 -m venv venv \u6fc0\u6d3b\u865a\u62df\u73af\u5883 # windows venv \\S cripts \\a ctivate # mac/linux source venv/bin/activate \u5b89\u88c5\u4f9d\u8d56 # windows pip install -r requirements.txt # mac / linux pip3 install -r requirements.txt \u8fd0\u884c # windows python run.py # mac/linux python3 run.py","title":"\u547d\u4ee4\u884c\u64cd\u4f5c"},{"location":"apiAutoTest/case/assert/","text":"\u673a\u5236 \u7edd\u5bf9\u76f8\u7b49\u7684\u65ad\u8a00\u5f62\u5f0f, \u591a\u4e2a\u65ad\u8a00\u65f6,\u4e00\u4e2a\u65ad\u8a00\u4e0d\u901a\u8fc7\u5219\u8be5\u7528\u4f8b\u4e0d\u901a\u8fc7 \u5b9e\u9645\u7ed3\u679c\u53ef\u52a8\u6001\u4ece\u5f53\u5f3a\u54cd\u5e94\u4e2d\u63d0\u53d6, \u9884\u671f\u7ed3\u679c\u53ef\u4ee5\u4f7f\u7528 $\u53d8\u91cf , ${\u51fd\u6570(\u53c2\u6570)} \u7528\u4f8b\u6570\u636e \u7528\u4f8b\u6807\u9898 \u662f\u5426\u8df3\u8fc7 \u8bf7\u6c42\u5934 \u8bf7\u6c42\u5730\u5740 \u8bf7\u6c42\u65b9\u5f0f \u5165\u53c2\u5173\u952e\u5b57 \u4e0a\u4f20\u6587\u4ef6 \u8bf7\u6c42\u6570\u636e \u63d0\u53d6\u53c2\u6570 \u540e\u7f6eSQL \u9884\u671f\u7ed3\u679c \u767b\u5f55 FALSE login post data {\"username\": \"admin\", \"password\": \"\"} {\"msg\":\"$.meta.msg\"} select * from apis; select * from cases {\"$.meta.status\":400} \u54cd\u5e94\u7ed3\u679c { \"data\" : null , \"meta\" : { \"msg\" : \"\u53c2\u6570\u9519\u8bef\" , \"status\" : 400 } } \u9884\u671f\u7ed3\u679c { \"$.meta.code\" : 400 } $.meta.code \u4e3a\u5b9e\u9645\u7ed3\u679c,\u4ece\u5f53\u524d\u54cd\u5e94\u63d0\u53d6\u5f97\u5230\u7ed3\u679c\u4e3a: 400 \u4e0a\u8ff0 $.meta.code \u7684value 400 \u4e3a\u9884\u671f\u7ed3\u679c \u65ad\u8a00\u7ed3\u679c \"\u5b9e\u9645\u7ed3\u679c:400 = \u9884\u671f\u7ed3\u679c:400\" \u591a\u4e2a\u65ad\u8a00 { \"$.meta.status\" : 400 , \"$.meata.msg\" : \"\u767b\u5f55\u6210\u529f\" }","title":"4.9 \u9884\u671f\u7ed3\u679c"},{"location":"apiAutoTest/case/base/","text":"\u793a\u4f8b \u00b6 \u7528\u4f8b\u6807\u9898 \u8be5\u5355\u5143\u683c\uff0c\u7b80\u8ff0\u8be5\u7528\u4f8b\u505a\u7684\u4e8b\u60c5\uff0c\u5c06\u4f53\u73b0\u5728 allure\u62a5\u544a \u4e2d \u8bf7\u6c42\u65b9\u5f0f get post delete put ... \u5165\u53c2\u5173\u952e\u5b57 params: url?\u53c2\u6570\u540d=\u53c2\u6570\u503c&\u53c2\u6570\u540d1=\u53c2\u6570\u503c1 \uff0c\u901a\u5e38\u7528\u5728get\u8bf7\u6c42\u4e0a\u3002 data\uff1a\u8bf7\u6c42\u5934content-type\u662ffrom\u8868\u5355\u7c7b\u578b\u3002 json\uff1a\u8bf7\u6c42\u5934content-type\uff1aapplication/json\u3002","title":"4.1 \u57fa\u672c\u4ecb\u7ecd"},{"location":"apiAutoTest/case/base/#_1","text":"\u7528\u4f8b\u6807\u9898 \u8be5\u5355\u5143\u683c\uff0c\u7b80\u8ff0\u8be5\u7528\u4f8b\u505a\u7684\u4e8b\u60c5\uff0c\u5c06\u4f53\u73b0\u5728 allure\u62a5\u544a \u4e2d \u8bf7\u6c42\u65b9\u5f0f get post delete put ... \u5165\u53c2\u5173\u952e\u5b57 params: url?\u53c2\u6570\u540d=\u53c2\u6570\u503c&\u53c2\u6570\u540d1=\u53c2\u6570\u503c1 \uff0c\u901a\u5e38\u7528\u5728get\u8bf7\u6c42\u4e0a\u3002 data\uff1a\u8bf7\u6c42\u5934content-type\u662ffrom\u8868\u5355\u7c7b\u578b\u3002 json\uff1a\u8bf7\u6c42\u5934content-type\uff1aapplication/json\u3002","title":"\u793a\u4f8b"},{"location":"apiAutoTest/case/data/","text":"\u524d\u7f6e\u5904\u7406 \u4f7f\u7528\u53d8\u91cf \u6765\u6e90\uff1a \u54cd\u5e94\u63d0\u53d6 \uff0c \u540e\u7f6eSQL\u7ed3\u679c \u4f7f\u7528 $\u53d8\u91cf\u540d \u7684\u65b9\u5f0f\u6765\u5f15\u7528\u53d8\u91cf \u4f7f\u7528\u51fd\u6570 \u6765\u6e90\uff1a tools/hooks.py \u5b9a\u4e49\u7684\u51fd\u6570 \u8c03\u7528\u65e0\u53c2\u65b9\u6cd5\uff1a ${\u65b9\u6cd5\u540d()} \u8c03\u7528\u6709\u53c2\u65b9\u6cd5\uff1a ${\u65b9\u6cd5\u540d(\u53c2\u6570)} \u7ecf\u8fc7\u4e0a\u9762\u4e24\u9053\u5de5\u5e8f\u5904\u7406\u4e4b\u540e\uff0c\u8fd4\u56de\u7684 data \u88ab\u8f6c\u4e3a dict \u3002 \u4f7f\u7528\u53c2\u6570\u53d8\u91cf \u7528\u4f8b\u6570\u636e \u7528\u4f8b\u6807\u9898 \u662f\u5426\u8df3\u8fc7 \u8bf7\u6c42\u5934 \u8bf7\u6c42\u5730\u5740 \u8bf7\u6c42\u65b9\u5f0f \u5165\u53c2\u5173\u952e\u5b57 \u4e0a\u4f20\u6587\u4ef6 \u8bf7\u6c42\u6570\u636e \u63d0\u53d6\u53c2\u6570 \u540e\u7f6eSQL \u9884\u671f\u7ed3\u679c \u767b\u5f55 FALSE login post data {\"username\": \"admin\", \"password\": \"$password\", \"age\": $age} {\"msg\":\"$.meta.msg\"} {\"$.meta.status\":400} \u8bbe\uff1a\u53d8\u91cf\u6c60 { \"password\" : 123456 , \"age\" : 18 } \u89e3\u6790\u8fc7\u7a0b ${password} -> \u53d8\u91cf\u6c60[\"password\"] -> 123456 $age -> \u53d8\u91cf\u6c60[\"age\"] -> 18 \u5219\uff1a \u6700\u7ec8\u8bf7\u6c42\u6570\u636e { \"username\" : \"admin\" , \"password\" : \"123456\" , \"age\" : 18 } \u4f7f\u7528\u81ea\u5b9a\u4e49\u65b9\u6cd5 \u7528\u4f8b\u6570\u636e \u7528\u4f8b\u6807\u9898 \u662f\u5426\u8df3\u8fc7 \u8bf7\u6c42\u5934 \u8bf7\u6c42\u5730\u5740 \u8bf7\u6c42\u65b9\u5f0f \u5165\u53c2\u5173\u952e\u5b57 \u4e0a\u4f20\u6587\u4ef6 \u8bf7\u6c42\u6570\u636e \u63d0\u53d6\u53c2\u6570 \u540e\u7f6eSQL \u9884\u671f\u7ed3\u679c \u767b\u5f55 FALSE {set_token( {set_token( token)} login post data {\"username\": \"${get_current_highest()}\", \"password\": \"123456\"} {\"msg\":\"$.meta.msg\"} {\"$.meta.status\":400} \u8bbe\uff1ahooks.py # hooks.py \u81ea\u5b9a\u4e49\u51fd\u6570\u5185\u5bb9\u5982\u4e0b import time def get_current_highest (): \"\"\"\u83b7\u53d6\u5f53\u524d\u65f6\u95f4\u6233\"\"\" return int ( time . time ()) def set_token ( token : str ): \"\"\"\u8bbe\u7f6etoken\uff0c\u76f4\u63a5\u8fd4\u56de\u5b57\u5178\"\"\" return { \"Authorization\" : token } \u8bbe\uff1a\u53d8\u91cf\u6c60 { \"token\" : \"123789token123\" } \u89e3\u6790\u8fc7\u7a0b ${token} -> \u53d8\u91cf\u6c60[\"token\"] -> \"123789token123\" ${get_current_highest()} -> \u6267\u884chooks.py\u4e2d\u7684get_current_highest() -> \"1621415799\" ${set_token(${token})} -> \u6267\u884chooks.py\u4e2d\u7684set_token(\"123789token123\") -> {\"Authorization\": \"123789token123\"} \u6700\u7ec8\u8bf7\u6c42\u6570\u636e \u8bf7\u6c42\u5934\uff08\u542b\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u57fa\u51c6header\uff09 { \"Accept-Encoding\" : \"gzip, deflate\" , \"Accept-Language\" : \"zh-CN,zh;q=0.9\" , \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36\" , \"Authorization\" : \"123789token123\" } \u8bf7\u6c42\u6570\u636e { \"username\" : \"1621415799\" , \"password\" : \"123456\" }","title":"4.6 \u8bf7\u6c42\u6570\u636e"},{"location":"apiAutoTest/case/extra/","text":"\u63d0\u53d6\u53d8\u91cf - JSONPATH\u5b66\u4e60 {\u53d8\u91cf\u540d: jsonpath\u8bed\u6cd5} \u4ece\u5f53\u524d\u7528\u4f8b\u7684\u54cd\u5e94\u7ed3\u679c\u4e2d\u63d0\u53d6\u503c\uff0c\u4ee5\u952e\u503c\u5bf9\u7684\u65b9\u5f0f,\u5c06\u5176\u52a0\u5165\u53c2\u6570\u53d8\u91cf\u6c60 \u5b57\u5178\u4e2d key \u4e0d\u80fd\u91cd\u590d\uff0c\u91cd\u590d\u65f6\u540e\u6dfb\u52a0\u7684 key - value \uff0c\u8986\u76d6\u4e4b\u524d\u7684. \u793a\u4f8b \u00b6 \u7528\u4f8b\u6807\u9898 \u662f\u5426\u8df3\u8fc7 \u8bf7\u6c42\u5934 \u8bf7\u6c42\u5730\u5740 \u8bf7\u6c42\u65b9\u5f0f \u5165\u53c2\u5173\u952e\u5b57 \u4e0a\u4f20\u6587\u4ef6 \u8bf7\u6c42\u6570\u636e \u63d0\u53d6\u53c2\u6570 \u540e\u7f6eSQL \u9884\u671f\u7ed3\u679c \u767b\u5f55 FALSE login post data {\"username\": \"admin\", \"password\": \"123456\"} {\"msg\":\"$.meta.msg\"} {\"$.meta.status\":400} \u8bbe\uff1a\u54cd\u5e94\u7ed3\u679c { \"data\" : { \"id\" : 500 , \"rid\" : 0 , \"username\" : \"admin\" , \"mobile\" : \"13761351161\" , \"email\" : \"adsfad@qq.com\" , \"token\" : \"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOjUwMCwicmlkIjowLCJpYXQiOjE2MjE0MTYyODMsImV4cCI6MTYyMTUwMjY4M30.7k9GP4XvECPiseneGTADNBGqXdHGJA1JrbCV1wS57ss\" }, \"meta\" : { \"msg\" : \"\u767b\u5f55\u6210\u529f\" , \"status\" : 200 } } \u89e3\u6790\u63d0\u53d6\u53c2\u6570\u680f { \"msg\" : \"\u767b\u5f55\u6210\u529f\" } $.meta.msg \u505a\u4e86\u4ec0\u4e48\u4e8b\u60c5\u5462? JSONPATH\u5b66\u4e60 $ \u4ee3\u8868\u7740\u54cd\u5e94\u5185\u5bb9\u7684\u6839\u76ee\u5f55\uff0c\u5219\u7406\u89e3\u4e3a\u6574\u4e2a { \"data\" : { \"id\" : 500 , \"rid\" : 0 , \"username\" : \"admin\" , \"mobile\" : \"13761351161\" , \"email\" : \"adsfad@qq.com\" , \"token\" : \"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOjUwMCwicmlkIjowLCJpYXQiOjE2MjE0MTYyODMsImV4cCI6MTYyMTUwMjY4M30.7k9GP4XvECPiseneGTADNBGqXdHGJA1JrbCV1wS57ss\" }, \"meta\" : { \"msg\" : \"\u767b\u5f55\u6210\u529f\" , \"status\" : 200 } } $.meta , \u4ee3\u8868\u627e\u5230\u6839\u76ee\u5f55\u4e0bkey\u4e3a meta \u7684value { \"msg\" : \"\u767b\u5f55\u6210\u529f\" , \"status\" : 200 } $.meta.msg , \u5219\u610f\u4e3a\u627e\u5230 \u6839\u76ee\u5f55 -> meta -> msg \u7684value \"\u767b\u5f55\u6210\u529f\" \u5f53\u524d\u53d8\u91cf\u6c60 { \"msg\" : \"\u767b\u5f55\u6210\u529f\" } \u63d0\u53d6\u591a\u4e2a: { \"\u53d8\u91cf\u540d1\" : \"jsonpath1\" , \"\u53d8\u91cf\u540d2\" : \"jsonpath2\" } \u62a5\u544a\u4e2d\u7684\u53c2\u6570\u53d8\u91cf\u6c60 \u00b6","title":"4.7 \u63d0\u53d6\u53c2\u6570"},{"location":"apiAutoTest/case/extra/#_1","text":"\u7528\u4f8b\u6807\u9898 \u662f\u5426\u8df3\u8fc7 \u8bf7\u6c42\u5934 \u8bf7\u6c42\u5730\u5740 \u8bf7\u6c42\u65b9\u5f0f \u5165\u53c2\u5173\u952e\u5b57 \u4e0a\u4f20\u6587\u4ef6 \u8bf7\u6c42\u6570\u636e \u63d0\u53d6\u53c2\u6570 \u540e\u7f6eSQL \u9884\u671f\u7ed3\u679c \u767b\u5f55 FALSE login post data {\"username\": \"admin\", \"password\": \"123456\"} {\"msg\":\"$.meta.msg\"} {\"$.meta.status\":400} \u8bbe\uff1a\u54cd\u5e94\u7ed3\u679c { \"data\" : { \"id\" : 500 , \"rid\" : 0 , \"username\" : \"admin\" , \"mobile\" : \"13761351161\" , \"email\" : \"adsfad@qq.com\" , \"token\" : \"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOjUwMCwicmlkIjowLCJpYXQiOjE2MjE0MTYyODMsImV4cCI6MTYyMTUwMjY4M30.7k9GP4XvECPiseneGTADNBGqXdHGJA1JrbCV1wS57ss\" }, \"meta\" : { \"msg\" : \"\u767b\u5f55\u6210\u529f\" , \"status\" : 200 } } \u89e3\u6790\u63d0\u53d6\u53c2\u6570\u680f { \"msg\" : \"\u767b\u5f55\u6210\u529f\" } $.meta.msg \u505a\u4e86\u4ec0\u4e48\u4e8b\u60c5\u5462? JSONPATH\u5b66\u4e60 $ \u4ee3\u8868\u7740\u54cd\u5e94\u5185\u5bb9\u7684\u6839\u76ee\u5f55\uff0c\u5219\u7406\u89e3\u4e3a\u6574\u4e2a { \"data\" : { \"id\" : 500 , \"rid\" : 0 , \"username\" : \"admin\" , \"mobile\" : \"13761351161\" , \"email\" : \"adsfad@qq.com\" , \"token\" : \"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1aWQiOjUwMCwicmlkIjowLCJpYXQiOjE2MjE0MTYyODMsImV4cCI6MTYyMTUwMjY4M30.7k9GP4XvECPiseneGTADNBGqXdHGJA1JrbCV1wS57ss\" }, \"meta\" : { \"msg\" : \"\u767b\u5f55\u6210\u529f\" , \"status\" : 200 } } $.meta , \u4ee3\u8868\u627e\u5230\u6839\u76ee\u5f55\u4e0bkey\u4e3a meta \u7684value { \"msg\" : \"\u767b\u5f55\u6210\u529f\" , \"status\" : 200 } $.meta.msg , \u5219\u610f\u4e3a\u627e\u5230 \u6839\u76ee\u5f55 -> meta -> msg \u7684value \"\u767b\u5f55\u6210\u529f\" \u5f53\u524d\u53d8\u91cf\u6c60 { \"msg\" : \"\u767b\u5f55\u6210\u529f\" } \u63d0\u53d6\u591a\u4e2a: { \"\u53d8\u91cf\u540d1\" : \"jsonpath1\" , \"\u53d8\u91cf\u540d2\" : \"jsonpath2\" }","title":"\u793a\u4f8b"},{"location":"apiAutoTest/case/extra/#_2","text":"","title":"\u62a5\u544a\u4e2d\u7684\u53c2\u6570\u53d8\u91cf\u6c60"},{"location":"apiAutoTest/case/files/","text":"\u63d0\u793a \u5185\u90e8\u5c06\u4f7f\u7528\u4e8c\u8fdb\u5236\u6d41\u65b9\u5f0f\u6253\u5f00\u672c\u5730\u6587\u4ef6\u5e76\u4e0a\u4f20\u5230\u63a5\u53e3\u5f53\u4e2d windows\u4e2d\u8def\u5f84\u4e2d\u76f4\u63a5\u4f7f\u7528 \\ , \u4f1a\u88ab\u8f6c\u4e49 \u4e0a\u4f20\u6587\u4ef6\u670d\u52a1 # \u672c\u5730\u51c6\u5907\u4e00\u4e2a\u4e0a\u4f20\u6587\u4ef6\u670d\u52a1 #!/usr/bin/env/ python3 # -*- coding:utf-8 -*- \"\"\" @Project: apiAutoTest @File :serve.py @Author:zy7y @Date :2021/5/19 @Desc : \"\"\" from typing import List from fastapi import FastAPI , File , UploadFile , Form app = FastAPI () @app . post ( \"/upload_file/\" , name = '\u4e0a\u4f20\u5355\u6587\u4ef6\u63a5\u53e3' ) async def create_upload_file ( file : UploadFile = File ( ... )): # \u5355\u6587\u4ef6\u4e0a\u4f20\u63a5\u53e3\uff0c\u5e76\u5c06\u6587\u4ef6\u5199\u5230\u670d\u52a1\u5668\u5730\u5740\uff0c \u63a5\u6536\u6587\u4ef6\u5bf9\u8c61\u7684\u53c2\u6570 \u662f file # \u8bfb\u53d6\u6587\u4ef6 contents = await file . read () # \u4fdd\u5b58\u672c\u5730 with open ( file . filename , \"wb\" ) as f : f . write ( contents ) return { 'msg' : '\u64cd\u4f5c\u6210\u529f' , \"filename\" : file . filename , \"meta\" : { \"msg\" : \"ok\" }, \"code\" : 200 } @app . post ( \"/upload_files/\" , name = '\u4e0a\u4f20\u591a\u4e2a\u6587\u4ef6' ) async def create_upload_files ( files : List [ UploadFile ] = File ( ... ), username : str = Form ( ... ), password : str = Form ( ... )): # \u591a\u6587\u4ef6\u4e0a\u4f20\u63a5\u53e3\uff0c\u5e76\u5c06\u6587\u4ef6\u5199\u5230\u670d\u52a1\u5668, \u63a5\u6536\u6587\u4ef6\u5bf9\u8c61\u7684\u53c2\u6570 \u662f files for file in files : # \u8bfb\u53d6\u6587\u4ef6 contents = await file . read () # \u4fdd\u5b58\u672c\u5730 with open ( file . filename , \"wb\" ) as f : f . write ( contents ) return { \"filenames\" : [ file . filename for file in files ], \"meta\" : { \"msg\" : \"ok\" }, \"code\" : 200 , \"username\" : username , \"password\" : password } if __name__ == '__main__' : # \u542f\u52a8\u9879\u76ee\u540e \u8bbf\u95ee http://127.0.0.1:8888/docs \u53ef\u67e5\u770b\u63a5\u53e3\u6587\u6863 import uvicorn uvicorn . run ( 'serve:app' , reload = True , port = 8888 ) # pip install fastapi uvicorn python-multipart \u4fee\u6539serve, core.py ... @property def path ( self ): return self . _path @path . setter def path ( self , value ): self . config . get_config ( \"$.server.test\" ) # \u8fd9\u91cc\u4fee\u6539\u4e86 self . _path = f \" { self . config . current }{ DataProcess . rep_expr ( value ) } \" @property def body ( self ): return self . _body ... \u4e0a\u4f20\u5355\u6587\u4ef6 \u7528\u4f8b\u6570\u636e \u7528\u4f8b\u6807\u9898 \u662f\u5426\u8df3\u8fc7 \u8bf7\u6c42\u5934 \u8bf7\u6c42\u5730\u5740 \u8bf7\u6c42\u65b9\u5f0f \u5165\u53c2\u5173\u952e\u5b57 \u4e0a\u4f20\u6587\u4ef6 \u8bf7\u6c42\u6570\u636e \u63d0\u53d6\u53c2\u6570 \u540e\u7f6eSQL \u9884\u671f\u7ed3\u679c \u4e0a\u4f20\u5355\u6587\u4ef6 FALSE upload_file post data {\"file\":\"D:/FastAPIProjects/apiAutoTestDocs/demo/mkdocs.yml\"} {\"code\":\"$.code\"} {\"$.code\":200} \u7ed3\u679c \u4e0a\u4f20\u591a\u6587\u4ef6 + \u8868\u5355\u6570\u636e \u7528\u4f8b\u6570\u636e \u7528\u4f8b\u6807\u9898 \u662f\u5426\u8df3\u8fc7 \u8bf7\u6c42\u5934 \u8bf7\u6c42\u5730\u5740 \u8bf7\u6c42\u65b9\u5f0f \u5165\u53c2\u5173\u952e\u5b57 \u4e0a\u4f20\u6587\u4ef6 \u8bf7\u6c42\u6570\u636e \u63d0\u53d6\u53c2\u6570 \u540e\u7f6eSQL \u9884\u671f\u7ed3\u679c \u4e0a\u4f20\u5355\u6587\u4ef6 FALSE upload_files post data {\"files\":[\"D:/FastAPIProjects/apiAutoTestDocs/demo/mkdocs.yml\", \"D:/FastAPIProjects/apiAutoTestDocs/demo/docs/index.md\"]} {\"username\": \"admin\", \"password\": \"\"} {\"$.code\":200} \u7ed3\u679c \u670d\u52a1\u7aef","title":"4.5 \u4e0a\u4f20\u6587\u4ef6"},{"location":"apiAutoTest/case/header/","text":"\u8bf7\u6c42\u5934 \u5b9e\u73b0\u539f\u7406, \u7ecf\u8fc7\u5185\u90e8\u5904\u7406\u4e4b\u540e\u62ff\u5230\u5355\u5143\u683c\u7684\u5185\u5bb9\u5e76\u8f6c\u6362\u6210 Dict \u6570\u636e\uff0c\u548c config.yaml \u4e2d\u7684 requestt_header \u8fdb\u884c \u5408\u5e76(update) \uff0c\u518d\u7528\u5408\u5e76\u4e4b\u540e\u7684 Dict \u53bb\u53d1\u9001\u8bf7\u6c42\u3002 \u524d\u7f6e\u5904\u7406 \u4f7f\u7528\u53d8\u91cf \u6765\u6e90\uff1a \u54cd\u5e94\u63d0\u53d6 \uff0c \u540e\u7f6eSQL\u7ed3\u679c \u4f7f\u7528 $\u53d8\u91cf\u540d \u7684\u65b9\u5f0f\u6765\u5f15\u7528\u53d8\u91cf \u4f7f\u7528\u51fd\u6570 \u6765\u6e90\uff1a thooks.py \u5b9a\u4e49\u7684\u51fd\u6570 \u8c03\u7528\u65e0\u53c2\u65b9\u6cd5\uff1a ${\u65b9\u6cd5\u540d()} \u8c03\u7528\u6709\u53c2\u65b9\u6cd5\uff1a ${\u65b9\u6cd5\u540d(\u53c2\u6570)} \u7ecf\u8fc7\u4e0a\u9762\u4e24\u9053\u5de5\u5e8f\u5904\u7406\u4e4b\u540e\uff0c\u8fd4\u56de\u7684 header \u5b57\u5178\uff0c\u5c06\u548c \u57fa\u51c6header \u5408\u5e76\u3002 config.yaml ... # \u57fa\u51c6\u7684\u8bf7\u6c42\u5934\u4fe1\u606f request_headers : Accept-Encoding : gzip, deflate Accept-Language : zh-CN,zh;q=0.9 User-Agent : Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36 ... \u8bf7\u6c42\u5934\u5355\u5143\u683c\u6709\u5185\u5bb9 \u7528\u4f8b\u6570\u636e \u7528\u4f8b\u6807\u9898 \u662f\u5426\u8df3\u8fc7 \u8bf7\u6c42\u5934 \u8bf7\u6c42\u5730\u5740 \u8bf7\u6c42\u65b9\u5f0f \u5165\u53c2\u5173\u952e\u5b57 \u4e0a\u4f20\u6587\u4ef6 \u8bf7\u6c42\u6570\u636e \u63d0\u53d6\u53c2\u6570 \u540e\u7f6eSQL \u9884\u671f\u7ed3\u679c get\u767b\u5f551 FALSE {\"c1\": \"c1\u6dfb\u52a0\u7684\u8bf7\u6c42\u5934\"} login get params {\"username\": \"admin\", \"password\": \"\"} {\"msg\":\"$.meta.msg\"} {\"$.meta.status\":400} \u6700\u7ec8\u8bf7\u6c42\u65f6 ,\u8bf7\u6c42\u5934\u5982\u4e0b { \"Accept-Encoding\" : \"gzip, deflate\" , \"Accept-Language\" : \"zh-CN,zh;q=0.9\" , \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36\" , \"c1\" : \"c1\u6dfb\u52a0\u7684\u8bf7\u6c42\u5934\" } \u8bf7\u6c42\u5934\u5355\u5143\u683c\u65e0\u5185\u5bb9 \u7528\u4f8b\u6570\u636e \u7528\u4f8b\u6807\u9898 \u662f\u5426\u8df3\u8fc7 \u8bf7\u6c42\u5934 \u8bf7\u6c42\u5730\u5740 \u8bf7\u6c42\u65b9\u5f0f \u5165\u53c2\u5173\u952e\u5b57 \u4e0a\u4f20\u6587\u4ef6 \u8bf7\u6c42\u6570\u636e \u63d0\u53d6\u53c2\u6570 \u540e\u7f6eSQL \u9884\u671f\u7ed3\u679c get\u767b\u5f551 FALSE login get params {\"username\": \"admin\", \"password\": \"\"} {\"msg\":\"$.meta.msg\"} {\"$.meta.status\":400} \u6700\u7ec8\u8bf7\u6c42\u65f6 ,\u8bf7\u6c42\u5934\u5982\u4e0b { \"Accept-Encoding\" : \"gzip, deflate\" , \"Accept-Language\" : \"zh-CN,zh;q=0.9\" , \"User-Agent\" : \"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/86.0.4240.198 Safari/537.36\" , } \u8be5\u5355\u5143\u683c\u652f\u6301\u5f15\u7528 $\u53d8\u91cf , ${\u51fd\u6570\u540d()} , ${\u51fd\u6570\u540d(\u53c2\u6570)}","title":"4.3 \u8bf7\u6c42\u5934"},{"location":"apiAutoTest/case/skip/","text":"\u7528\u4f8b\u8df3\u8fc7 \u5b9e\u73b0\u539f\u7406, \u7ecf\u8fc7\u5185\u90e8\u5904\u7406\u4e4b\u540e\u62ff\u5230\u4e00\u4e2a True or False \uff0c\u5982\u679c\u662f True \u5219\u629b\u51fa\u4e00\u4e2a Skipped \u5f02\u5e38 \u524d\u7f6e\u5904\u7406 \u4f7f\u7528\u53d8\u91cf \u6765\u6e90\uff1a \u54cd\u5e94\u63d0\u53d6 \uff0c \u540e\u7f6eSQL\u7ed3\u679c \u4f7f\u7528 $\u53d8\u91cf\u540d \u7684\u65b9\u5f0f\u6765\u5f15\u7528\u53d8\u91cf \u4f7f\u7528\u51fd\u6570 \u6765\u6e90\uff1a hooks.py \u5b9a\u4e49\u7684\u51fd\u6570 \u8c03\u7528\u65e0\u53c2\u65b9\u6cd5\uff1a ${\u65b9\u6cd5\u540d()} \u8c03\u7528\u6709\u53c2\u65b9\u6cd5\uff1a ${\u65b9\u6cd5\u540d(\u53c2\u6570)} \u6267\u884c\u8868\u8fbe\u5f0f \u8bfb\u53d6\u5355\u5143\u683c\u5b57\u7b26\u5185\u5bb9\u540e\uff0c\u88abPython\u8f6c\u6362\u6210\u5bf9\u5e94\u7684\u5e03\u5c14\u503c \u6761\u4ef6\u8868\u8fbe\u5f0f\uff1a 1>2 \u7528\u4f8b\u6570\u636e \u7528\u4f8b\u6807\u9898 \u662f\u5426\u8df3\u8fc7 \u8bf7\u6c42\u5934 \u8bf7\u6c42\u5730\u5740 \u8bf7\u6c42\u65b9\u5f0f \u5165\u53c2\u5173\u952e\u5b57 \u4e0a\u4f20\u6587\u4ef6 \u8bf7\u6c42\u6570\u636e \u63d0\u53d6\u53c2\u6570 \u540e\u7f6eSQL \u9884\u671f\u7ed3\u679c get\u767b\u5f551 1>2 {\"c1\": \"\u6761\u4ef6\u6bd4\u8f83\"} login get params {\"username\": \"admin\", \"password\": \"\"} {\"msg\":\"$.meta.msg\"} {\"$.meta.status\":400} \u5b9e\u9645\u7ed3\u679c \u4e0a\u8ff0\u5185\u5bb9\u5728Python\u4e2d 1 > 2 \u7ed3\u679c\u4e3a False , \u6240\u4ee5\u8fd9\u6761\u7528\u4f8b\u6267\u884c \u5f15\u7528\u53d8\u91cf\uff1a $userId > 1000 \u7528\u4f8b\u6570\u636e \u7528\u4f8b\u6807\u9898 \u662f\u5426\u8df3\u8fc7 \u8bf7\u6c42\u5934 \u8bf7\u6c42\u5730\u5740 \u8bf7\u6c42\u65b9\u5f0f \u5165\u53c2\u5173\u952e\u5b57 \u4e0a\u4f20\u6587\u4ef6 \u8bf7\u6c42\u6570\u636e \u63d0\u53d6\u53c2\u6570 \u540e\u7f6eSQL \u9884\u671f\u7ed3\u679c get\u767b\u5f551 $userId > 1000 {\"c1\": \"\u6761\u4ef6\u6bd4\u8f83\"} login get params {\"username\": \"admin\", \"password\": \"\"} {\"msg\":\"$.meta.msg\"} {\"$.meta.status\":400} \u5047\u8bbe\u53d8\u91cf\u6c60\u6570\u636e { \"userId\" : 10001 } \u5b9e\u9645\u7ed3\u679c \u4e0a\u8ff0\u5185\u5bb9\u5148\u5904\u7406 $userId -> 10001 \uff0c \u518dPython \u4e2d 10001 > 1000 \uff0c\u7ed3\u679c\u4e3a True , \u8be5\u7528\u4f8b\u8df3\u8fc7\uff0c\u4e0d\u6267\u884c \u5f15\u7528\u51fd\u6570 ${skip()} \u7528\u4f8b\u6570\u636e \u7528\u4f8b\u6807\u9898 \u662f\u5426\u8df3\u8fc7 \u8bf7\u6c42\u5934 \u8bf7\u6c42\u5730\u5740 \u8bf7\u6c42\u65b9\u5f0f \u5165\u53c2\u5173\u952e\u5b57 \u4e0a\u4f20\u6587\u4ef6 \u8bf7\u6c42\u6570\u636e \u63d0\u53d6\u53c2\u6570 \u540e\u7f6eSQL \u9884\u671f\u7ed3\u679c get\u767b\u5f551 ${skip()} {\"c1\": \"\u6761\u4ef6\u6bd4\u8f83\"} login get params {\"username\": \"admin\", \"password\": \"\"} {\"msg\":\"$.meta.msg\"} {\"$.meta.status\":400} \u5047\u8bbe hooks.py def skip (): return True \u5b9e\u9645\u7ed3\u679c \u4e0a\u8ff0\u5185\u5bb9\u5148\u5904\u7406 ${skip()} -> True \uff0c \u518dPython \u4e2d\u7ed3\u679c\u4e3a True , \u8be5\u7528\u4f8b\u8df3\u8fc7\u4e0d\u6267\u884c \u7ecf\u8fc7\u6d4b\u8bd5\u5355\u5143\u683c\u5185\u5bb9\u4e3aTRUE -> Python True FALSE -> Python False","title":"4.2 \u662f\u5426\u8df3\u8fc7"},{"location":"apiAutoTest/case/sql/","text":"\u539f\u7406 \u53d1\u9001\u8bf7\u6c42\u4e4b\u540e\uff0c\u6267\u884cSQL\uff0c\u5e76\u628a\u7ed3\u679c\u52a0\u5165\u5230\u53c2\u6570\u6c60\u4e2d \u5b58\u5728 ${} \u8bed\u6cd5\u5c06\u5904\u7406\u540e\u518d\u53bb\u6267\u884cSQL\u8bed\u53e5 \u524d\u7f6e\u5904\u7406 \u4f7f\u7528\u53d8\u91cf \u6765\u6e90\uff1a \u54cd\u5e94\u63d0\u53d6 \uff0c \u540e\u7f6eSQL\u7ed3\u679c \u4f7f\u7528 $\u53d8\u91cf\u540d \u7684\u65b9\u5f0f\u6765\u5f15\u7528\u53d8\u91cf \u4f7f\u7528\u51fd\u6570 \u6765\u6e90\uff1a tools/hooks.py \u5b9a\u4e49\u7684\u51fd\u6570 \u8c03\u7528\u65e0\u53c2\u65b9\u6cd5\uff1a ${\u65b9\u6cd5\u540d()} \u8c03\u7528\u6709\u53c2\u65b9\u6cd5\uff1a ${\u65b9\u6cd5\u540d(\u53c2\u6570)} \u7ecf\u8fc7\u4e0a\u9762\u4e24\u9053\u5de5\u5e8f\u5904\u7406\u4e4b\u540e\uff0c\u8fd4\u56de sql \uff0c\u518d\u6267\u884c\u3002 test_main.py ... def test_start ( case , get_db ): # \u53ea\u4f7f\u7528\u6570\u636e\u5e93\u64cd\u4f5c \"\"\" \u6d4b\u8bd5\u542f\u52a8\u65b9\u6cd5\uff0c \u5f53\u9700\u8981\u4f7f\u7528 \u6570\u636e\u6e05\u6d17\u548c \u6570\u636e\u5e93\u64cd\u4f5c\u547d\u4ee4\u65f6\u5c06 get_db \u6362\u6210 clear_db \u5982\u53ea\u9700\u8981\u4f7f\u7528 \u6570\u636e\u5e93\u64cd\u4f5c \u5219\u6dfb\u52a0get_db \u53c2\u6570\uff0c \u5982\u4e00\u4e2a\u90fd\u4e0d\u9700\u8981\u5219\u4e0d\u6dfb\u52a0 :param case: \u7528\u4f8b :return: \"\"\" # \u524d\u7f6e\u5904\u7406 title , skip , header , path , method , data_type , file , data , extra , sql , expect = case ReportStyle . title ( title ) data_process . handle_case ( path , header , skip , data , file ) # \u53d1\u9001\u8bf7\u6c42 http_client . send_request ( data_type , method , data_process . path , data_process . headers , data_process . body , data_process . files , ) # \u540e\u7f6e\u5904\u7406 DataProcess . handle_extra ( extra , http_client . response . json ()) data_process . sql = sql data_process . handle_sql ( get_db ) # \u4f7f\u7528\u6570\u636e\u5e93 # \u65ad\u8a00 DataProcess . assert_result ( http_client . response . json (), expect ) ... config.yaml # \u6570\u636e\u5e93\u6821\u9a8c- mysql database : host : localhost port : 3306 user : root # \u4e0d\u7528''\u4f1a\u88ab\u89e3\u6790\u6210int\u7c7b\u578b\u6570\u636e password : '123456' db : mydb # \u6570\u636e\u5e93\u6240\u5728\u7684\u670d\u52a1\u5668\u914d\u7f6e ssh_server : port : 22 username : root password : '123456' # \u79c1\u6709\u5bc6\u94a5\u6587\u4ef6\u8def\u5f84 private_key_file : # \u79c1\u94a5\u5bc6\u7801 private_password : # \u5982\u679c\u4f7f\u7528\u7684docker\u5bb9\u5668\u90e8\u7f72mysql\u670d\u52a1\uff0c\u9700\u8981\u4f20\u5165mysql\u7684\u5bb9\u5668id/name mysql_container : mysql8 # \u6570\u636e\u5e93\u5907\u4efd\u6587\u4ef6\u5bfc\u51fa\u7684\u672c\u5730\u8def\u5f84, \u9700\u8981\u4fdd\u8bc1\u5b58\u5728\u8be5\u6587\u4ef6\u5939 sql_data_file : backup_sql/ \u8868\u6570\u636e apis\u8868 cases\u8868 \u5355\u6761SQL \u7528\u4f8b\u6570\u636e \u7528\u4f8b\u6807\u9898 \u662f\u5426\u8df3\u8fc7 \u8bf7\u6c42\u5934 \u8bf7\u6c42\u5730\u5740 \u8bf7\u6c42\u65b9\u5f0f \u5165\u53c2\u5173\u952e\u5b57 \u4e0a\u4f20\u6587\u4ef6 \u8bf7\u6c42\u6570\u636e \u63d0\u53d6\u53c2\u6570 \u540e\u7f6eSQL \u9884\u671f\u7ed3\u679c \u767b\u5f55 FALSE login post data {\"username\": \"admin\", \"password\": \"\"} {\"msg\":\"$.meta.msg\"} select * from apis; {\"$.meta.status\":400} \u7ed3\u679c \u6267\u884c\u53c2\u6570\u5b57\u5178\u4e3a: { \"msg\" : \"\u53c2\u6570\u9519\u8bef\" } sql\u6267\u884c\u7ed3\u679c\u4e3a: null \u591a\u6761SQL \u7528\u4f8b\u6570\u636e \u7528\u4f8b\u6807\u9898 \u662f\u5426\u8df3\u8fc7 \u8bf7\u6c42\u5934 \u8bf7\u6c42\u5730\u5740 \u8bf7\u6c42\u65b9\u5f0f \u5165\u53c2\u5173\u952e\u5b57 \u4e0a\u4f20\u6587\u4ef6 \u8bf7\u6c42\u6570\u636e \u63d0\u53d6\u53c2\u6570 \u540e\u7f6eSQL \u9884\u671f\u7ed3\u679c \u767b\u5f55 FALSE login post data {\"username\": \"admin\", \"password\": \"\"} {\"msg\":\"$.meta.msg\"} select * from apis; select * from cases {\"$.meta.status\":400} \u7ed3\u679c \u6267\u884c\u540e\u53c2\u6570\u5b57\u5178\u4e3a: { \"msg\" : \"\u53c2\u6570\u9519\u8bef\" , \"id\" : 1 , \"name\" : \"updatehahaha\" , \"path\" : null , \"body\" : null , \"expected\" : \"{\\\"msg\\\": \\\"\u4f60\u597d\\\"}\" , \"api_id\" : 1 , \"create_at\" : \"2021-05-17 17:23:54\" , \"update_at\" : \"2021-05-17 17:23:54\" } sql\u6267\u884c\u7ed3\u679c\u4e3a: { \"id\" : 1 , \"name\" : \"updatehahaha\" , \"path\" : null , \"body\" : null , \"expected\" : \"{\\\"msg\\\": \\\"\u4f60\u597d\\\"}\" , \"api_id\" : 1 , \"create_at\" : \"2021-05-17 17:23:54\" , \"update_at\" : \"2021-05-17 17:23:54\" }","title":"4.8 \u540e\u7f6esql"},{"location":"apiAutoTest/case/url/","text":"\u7528\u4f8b\u8df3\u8fc7 \u5b9e\u73b0\u539f\u7406, \u7ecf\u8fc7\u5185\u90e8\u5904\u7406(\u53d8\u91cf/\u51fd\u6570\u7ed3\u679c \u66ff\u6362)\u4e4b\u540e\u62ff\u5230 \u63a5\u53e3\u5730\u5740\u7684\u5b57\u7b26\u4e32 \uff0c\u518d\u5728 config.yaml \u4e2d serve \u5bf9\u5e94\u7684\u57fa\u51c6\u5730\u5740\u540e\u8ffd\u52a0\u8be5\u5b57\u7b26\u4e32\uff0c\u518d\u53d1\u9001\u8bf7\u6c42\u3002 \u524d\u7f6e\u5904\u7406 \u4f7f\u7528\u53d8\u91cf \u6765\u6e90\uff1a \u54cd\u5e94\u63d0\u53d6 \uff0c \u540e\u7f6eSQL\u7ed3\u679c \u4f7f\u7528 $\u53d8\u91cf\u540d \u7684\u65b9\u5f0f\u6765\u5f15\u7528\u53d8\u91cf \u4f7f\u7528\u51fd\u6570 \u6765\u6e90\uff1a hooks.py \u5b9a\u4e49\u7684\u51fd\u6570 \u8c03\u7528\u65e0\u53c2\u65b9\u6cd5\uff1a ${\u65b9\u6cd5\u540d()} \u8c03\u7528\u6709\u53c2\u65b9\u6cd5\uff1a ${\u65b9\u6cd5\u540d(\u53c2\u6570)} \u7ecf\u8fc7\u4e0a\u9762\u4e24\u9053\u5de5\u5e8f\u5904\u7406\u4e4b\u540e\uff0c\u8fd4\u56de\u7684 url \u5c06\u88ab\u8ffd\u52a0\u5230 \u73af\u5883url\u672b\u5c3e config.yaml ... server : test : http://127.0.0.1:8888/ dev : http://127.0.0.1:8888/api/private/v1/ ... \u7528\u4f8b\u6570\u636e \u7528\u4f8b\u6807\u9898 \u662f\u5426\u8df3\u8fc7 \u8bf7\u6c42\u5934 \u8bf7\u6c42\u5730\u5740 \u8bf7\u6c42\u65b9\u5f0f \u5165\u53c2\u5173\u952e\u5b57 \u4e0a\u4f20\u6587\u4ef6 \u8bf7\u6c42\u6570\u636e \u63d0\u53d6\u53c2\u6570 \u540e\u7f6eSQL \u9884\u671f\u7ed3\u679c get\u767b\u5f551 FALSE {\"c1\": \"c1\u6dfb\u52a0\u7684\u8bf7\u6c42\u5934\"} login/ user/ user/ {get_time()} get params {\"username\": \"admin\", \"password\": \"\"} {\"msg\":\"$.meta.msg\"} {\"$.meta.status\":400} \u524d\u7f6e\u6570\u636e \u5df2\u6709\u53d8\u91cf\u6c60\u6570\u636e\u5982\u4e0b { \"user\" : \"vx\" } \u5df2\u6709 hooks.py def get_time (): return \"20180101\" \u6700\u7ec8\u8bf7\u6c42\u5730\u5740 http://localhost:8888/api/private/v1/login/vx/20180101 \u8be5\u5355\u5143\u683c\u652f\u6301\u5f15\u7528 $\u53d8\u91cf , ${\u51fd\u6570\u540d()} , ${\u51fd\u6570\u540d(\u53c2\u6570)}","title":"4.4 \u63a5\u53e3\u5730\u5740"}]}